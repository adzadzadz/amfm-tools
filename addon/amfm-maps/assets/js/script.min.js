(()=>{jQuery(document).ready(function(_){if(!_("#amfm-drawer").length){var t=_(".amfm-map-wrapper").length?_(".amfm-map-wrapper"):_("body");t.append(`
            <div id="amfm-drawer-overlay" class="amfm-drawer-overlay"></div>
            <div id="amfm-drawer" class="amfm-drawer">
                <div id="amfm-drawer-content" class="amfm-drawer-content"></div>
            </div>
        `),jQuery("#amfm-drawer-overlay").on("click",function(){S()})}function S(){jQuery("#amfm-drawer").removeClass("open"),jQuery("#amfm-drawer-overlay").removeClass("visible"),jQuery("body").off("click.drawer")}function P(L){if(!jQuery("#amfm-drawer").length){var g=jQuery(".amfm-map-wrapper").length?jQuery(".amfm-map-wrapper"):jQuery("body");g.append(`
                <div id="amfm-drawer-overlay" class="amfm-drawer-overlay"></div>
                <div id="amfm-drawer" class="amfm-drawer">
                    <div id="amfm-drawer-content" class="amfm-drawer-content"></div>
                </div>
            `),jQuery("#amfm-drawer-overlay").on("click",function(){S()})}jQuery("#amfm-drawer-content").html(L),setTimeout(function(){jQuery("#amfm-drawer").addClass("open"),jQuery("#amfm-drawer-overlay").addClass("visible")},10),jQuery("body").off("click.drawer"),setTimeout(function(){jQuery("body").on("click.drawer",function(l){const C=jQuery("#amfm-drawer"),d=jQuery("#amfm-drawer-overlay");!C.is(l.target)&&C.has(l.target).length===0&&S()})},100)}window.openDrawer=P,window.testDrawer=function(){P('<div style="padding: 20px;"><h3>Test Drawer</h3><p>This is a test to see if the drawer is working.</p></div>')}});var R={};window.amfm=R;window.amfmMap||(window.amfmMap={maps:{},markers:{},instances:{},filteredData:{},loadLocations:{},map:null,markers:[],loadLocations:null});var r=window.amfmMap;r.init=function(_){var t=_.unique_id;if(r.instances&&r.instances[t])return;var S=_.json_data,P=_.api_key,L,g=[],l=S.slice();r.markers||(r.markers={}),r.filteredData||(r.filteredData={}),r.instances||(r.instances={}),r.maps||(r.maps={}),r.loadLocations||(r.loadLocations={}),r.markers[t]=g,r.filteredData[t]=l,r.instances[t]=_;function C(){var e=document.getElementById(t+"_map");if(!e)return;e.style.background="";var a={lat:39.8283,lng:-98.5795};L=new google.maps.Map(e,{center:a,zoom:4,mapTypeControl:!1,zoomControl:!0,streetViewControl:!1,fullscreenControl:!0}),r.maps[t]=L,r.map||(r.map=L);function m(){l=S.filter(function(f){return f.PlaceID}),A(l.length),y(l),r.loadLocations[t]=y,r.loadLocations||(r.loadLocations=y),$()}setTimeout(function(){(!r.loadLocations||!r.loadLocations[t])&&m()},100),google.maps.event.addListenerOnce(L,"idle",function(){(!r.loadLocations||!r.loadLocations[t])&&m()}),setTimeout(function(){(!r.loadLocations||!r.loadLocations[t])&&m()},2e3)}function d(){var e=document.getElementById(t+"_map");e&&typeof google!="undefined"&&google.maps&&google.maps.Map?C():(e&&(e.style.background=`#f0f0f0 url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 50 50'%3E%3Cpath d='M25,5A20.14,20.14,0,0,1,45,22.88a2.51,2.51,0,0,0,2.49,2.26h0A2.52,2.52,0,0,0,50,22.33a25.14,25.14,0,0,0-50,0,2.52,2.52,0,0,0,2.5,2.81h0A2.51,2.51,0,0,0,5,22.88,20.14,20.14,0,0,1,25,5Z'%3E%3CanimateTransform attributeName='transform' type='rotate' from='0 25 25' to='360 25 25' dur='0.5s' repeatCount='indefinite'/%3E%3C/path%3E%3C/svg%3E") center center no-repeat`),setTimeout(d,300))}d();function y(e){if(!e||e.length===0){b(),A(0);return}var a=new google.maps.LatLngBounds,m=new google.maps.places.PlacesService(L),f=0,i=0,u=e.filter(o=>o.PlaceID).length,n=e.map(o=>o.PlaceID).filter(o=>o);if(u===0){b(),A(0);return}b(),g.forEach(function(o){n.includes(o.placeId)&&(o.marker.setVisible(!0),a.extend(o.marker.getPosition()),f++)});var s=g.map(o=>o.placeId),k=n.filter(o=>!s.includes(o));if(k.length===0){A(f),f>0&&!a.isEmpty()&&L.fitBounds(a);return}e.forEach(function(o){if(!(!o.PlaceID||s.includes(o.PlaceID))){var I={placeId:o.PlaceID,fields:["name","geometry","formatted_address","photos","rating","opening_hours","formatted_phone_number","website"]};m.getDetails(I,function(h,q){if(i++,q===google.maps.places.PlacesServiceStatus.OK){var j=new google.maps.Marker({map:L,position:h.geometry.location,title:h.name}),v={marker:j,placeId:o.PlaceID,location:o,place:h};g.push(v),a.extend(h.geometry.location),f++,j.addListener("click",function(){var p=w(h,o);typeof openDrawer=="function"?openDrawer(p):typeof window.openDrawer=="function"&&window.openDrawer(p),g.forEach(function(M){M.infoWindow&&M.infoWindow.close()})})}i===k.length&&(A(f),!a.isEmpty()&&f>0&&(L.fitBounds(a),google.maps.event.addListenerOnce(L,"idle",function(){L.getZoom()>10&&L.setZoom(10)})))})}})}function b(){g.forEach(function(e){e.marker.setVisible(!1),e.infoWindow&&e.infoWindow.close()})}function w(e,a){var m=e.photos||[],f="";if(m.length>0){var i=m[0],u=i.getUrl({maxWidth:400,maxHeight:250});f=`
                <img src="${u}" alt="Location Photo">
            `}else a&&a.Image&&(f=`
                <img src="${a.Image}" alt="Location Image">
            `);var n=e.website;if(n)try{const I=new URL(n),h=new URLSearchParams(I.search);h.delete("utm_source"),h.delete("utm_medium"),h.delete("utm_campaign"),n=I.origin+I.pathname+(h.toString()?"?"+h.toString():"")}catch(I){}var s=`
            <!-- Name -->
            <div class="amfm-map-drawer-info-name">
            ${e.name||(a==null?void 0:a["(Internal) Name"])||"AMFM Location"}
            </div>
            
            <!-- Address -->
            <div class="amfm-map-drawer-info-address">
            <i class="fas fa-map-marker-alt" style="margin-right: 5px;"></i>
            ${e.formatted_address||"Address not available"}
            </div>

            <!-- Rating -->
            ${e.rating?`<div class="amfm-map-drawer-info-rating">
            <span style="color: #333; margin-right: 5px;">${e.rating.toFixed(1)}</span> 
            <span style="color: #ffc107;">${c(e.rating)}</span>
            </div>`:""}
        `,k=`
            <!-- Website Button -->
            ${n?`<div>
                <a href="${n}" target="_blank" class="amfm-website-button amfm-drawer-action">
                    View Location
                </a>
            </div>`:""}

            <!-- Phone Number Button -->
            ${e.formatted_phone_number?`<div>
                <a href="tel:${e.formatted_phone_number}" class="amfm-phone-button amfm-drawer-action">
                    ${e.formatted_phone_number}
                </a>
            </div>`:""}
        `,o=`
            <div class="amfm-map-info-content">
                <div class="amfm-maps-drawer-left">
                    <div class="amfm-maps-single-photo">
                        ${f}
                    </div>
                </div>
                <div class="amfm-maps-drawer-right">
                    <div class="amfm-maps-info-wrapper">
                        ${s}
                    </div>
                    <div class="amfm-maps-drawer-actions">
                        ${k}
                    </div>
                </div>
            </div>
        `;return o}function c(e){for(var a="",m=Math.floor(e),f=e%1>=.5,i=0;i<m;i++)a+="\u2605";f&&(a+="\u2606");for(var i=m+(f?1:0);i<5;i++)a+="\u2606";return a}function E(){return window.innerWidth<=768||/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function B(){g.forEach(function(e){e.infoWindow&&e.infoWindow.close(),e.marker.setMap(null)}),g=[],r.markers[t]=g}function D(e){A(e)}function A(e){var a=document.getElementById(t+"_counter");a&&(a.textContent="Showing "+e+" location"+(e!==1?"s":""))}function $(){var e=document.getElementById(t);if(e){e.addEventListener("amfmFilterUpdate",function(i){var u=i.detail.filters;V(u)});var a=e.querySelectorAll(".amfm-filter-button:not(.amfm-clear-filters)"),m=e.querySelectorAll('input[type="checkbox"]'),f=e.querySelector(".amfm-clear-filters");(a.length>0||m.length>0)&&(a.forEach(function(i){i.addEventListener("click",function(){var u=i.getAttribute("data-filter-type");if(u==="gender")if(i.classList.contains("active"))i.classList.remove("active");else{var n=e.querySelectorAll('.amfm-filter-button[data-filter-type="gender"]');n.forEach(function(s){s.classList.remove("active")}),i.classList.add("active")}else i.classList.toggle("active");W()})}),m.forEach(function(i){i.addEventListener("change",function(){W()})}),f&&f.addEventListener("click",function(){O()}))}}function V(e){var n;var a=r.maps[t],m=r.markers[t],f=(n=r.instances[t])==null?void 0:n.json_data;if(!(!a||!f)){var i=f.filter(function(s){if(!s.PlaceID)return!1;var k=Object.values(e).some(p=>p.length>0);if(!k)return!0;if(e.location&&e.location.length>0){var o=!1;if(e.location.forEach(function(p){var M=Q(p);s.State===M&&(o=!0)}),!o)return!1}if(e.region&&e.region.length>0){var I=!1;if(e.region.forEach(function(p){s.Region===p&&(I=!0)}),!I)return!1}if(e.gender&&e.gender.length>0&&!e.gender.includes(s["Details: Gender"]))return!1;if(e.conditions&&e.conditions.length>0){var h=!0;if(e.conditions.forEach(function(p){s["Conditions: "+p]!=1&&(h=!1)}),!h)return!1}if(e.programs&&e.programs.length>0){var q=!0;if(e.programs.forEach(function(p){s["Programs: "+p]!=1&&(q=!1)}),!q)return!1}if(e.accommodations&&e.accommodations.length>0){var j=!0;if(e.accommodations.forEach(function(p){s["Accommodations: "+p]!=1&&(j=!1)}),!j)return!1}if(e.level_of_care&&e.level_of_care.length>0){var v=!0;if(e.level_of_care.forEach(function(p){s["Level of Care: "+p]!=1&&(v=!1)}),!v)return!1}return!0});r.filteredData[t]=i,r.map===a&&(r.filteredData=i),A(i.length);var u=r.loadLocations[t];u&&u(i)}}function W(){var e=document.getElementById(t);if(e){var a={location:[],region:[],gender:[],conditions:[],programs:[],accommodations:[],level_of_care:[]},m=e.querySelectorAll(".amfm-filter-button.active:not(.amfm-clear-filters)");m.forEach(function(n){var s=n.getAttribute("data-filter-type"),k=n.getAttribute("data-filter-value");a[s]&&a[s].push(k)});var f=e.querySelectorAll('input[type="checkbox"]:checked');f.forEach(function(n){var s=n.name,k=n.value;a[s]&&a[s].push(k)}),l=S.filter(function(n){if(!n.PlaceID)return!1;var s=Object.values(a).some(v=>v.length>0);if(!s)return!0;if(a.location.length>0){var k=!1;if(a.location.forEach(function(v){var p=Q(v);n.State===p&&(k=!0)}),!k)return!1}if(a.region&&a.region.length>0){var o=!1;if(a.region.forEach(function(v){n.Region===v&&(o=!0)}),!o)return!1}if(a.gender.length>0&&!a.gender.includes(n["Details: Gender"]))return!1;if(a.conditions.length>0){var I=!0;if(a.conditions.forEach(function(v){n["Conditions: "+v]!=1&&(I=!1)}),!I)return!1}if(a.programs.length>0){var h=!0;if(a.programs.forEach(function(v){n["Programs: "+v]!=1&&(h=!1)}),!h)return!1}if(a.accommodations.length>0){var q=!0;if(a.accommodations.forEach(function(v){n["Accommodations: "+v]!=1&&(q=!1)}),!q)return!1}if(a.level_of_care.length>0){var j=!0;if(a.level_of_care.forEach(function(v){n["Level of Care: "+v]!=1&&(j=!1)}),!j)return!1}return!0}),r.filteredData[t]=l;var i=r.maps[t];r.map===i&&(r.filteredData=l),A(l.length);var u=r.loadLocations[t];u&&u(l)}}function O(){var e=document.getElementById(t);if(e){var a=e.querySelectorAll(".amfm-filter-button.active:not(.amfm-clear-filters)");a.forEach(function(u){u.classList.remove("active")});var m=e.querySelectorAll('input[type="checkbox"]');m.forEach(function(u){u.checked=!1}),l=S.filter(function(u){return u.PlaceID}),r.filteredData[t]=l;var f=r.maps[t];r.map===f&&(r.filteredData=l),A(l.length);var i=r.loadLocations[t];i&&i(l)}}function Q(e){var a={California:"CA",Virginia:"VA",Washington:"WA",Minnesota:"MN",Oregon:"OR"};return a[e]||e}};var T={};window.amfmMapFilter=T;T.init=function(_){var t=_.unique_id,S=_.target_map_id,P=_.json_data;function L(){var d=document.getElementById(t);if(d){var y=d.querySelectorAll(".amfm-filter-button:not(.amfm-clear-filters)"),b=d.querySelectorAll('input[type="checkbox"]'),w=d.querySelector(".amfm-clear-filters");y.forEach(function(c){c.addEventListener("click",function(){var E=c.getAttribute("data-filter-type");if(E==="gender")if(c.classList.contains("active"))c.classList.remove("active");else{var B=d.querySelectorAll('.amfm-filter-button[data-filter-type="gender"]');B.forEach(function(D){D.classList.remove("active")}),c.classList.add("active")}else c.classList.toggle("active");l()})}),b.forEach(function(c){c.addEventListener("change",function(){l()})}),w&&w.addEventListener("click",function(){C()})}}function g(){var d=document.getElementById(t);if(!d)return{};var y={location:[],region:[],gender:[],conditions:[],programs:[],accommodations:[],level_of_care:[]},b=d.querySelectorAll(".amfm-filter-button.active:not(.amfm-clear-filters)");b.forEach(function(c){var E=c.getAttribute("data-filter-type"),B=c.getAttribute("data-filter-value");y[E]&&y[E].push(B)});var w=d.querySelectorAll('input[type="checkbox"]:checked');return w.forEach(function(c){var E=c.name,B=c.value;y[E]&&y[E].push(B)}),y}function l(){var d=g();function y(w){var c=[];if(w){var E=document.getElementById(w);if(E){var B=E.querySelector(".amfm-map-container");B&&c.push(B.id)}E&&E.classList.contains("amfm-map-container")&&c.push(w)}if(c.length===0){var D=document.querySelectorAll(".amfm-map-container");D.forEach(function(A){A.id&&c.push(A.id)})}return c}var b=[];S?b=y(S):b=y(null),b.forEach(function(w){var c=new CustomEvent("amfmFilterUpdate",{detail:{filters:d,sourceFilterId:t}}),E=document.getElementById(w);E&&E.dispatchEvent(c)})}function C(){var d=document.getElementById(t);if(d){var y=d.querySelectorAll(".amfm-filter-button.active:not(.amfm-clear-filters)");y.forEach(function(w){w.classList.remove("active")});var b=d.querySelectorAll('input[type="checkbox"]');b.forEach(function(w){w.checked=!1}),l()}}return L(),{getActiveFilters:g,clearAllFilters:C,notifyMapWidgets:l}};})();
